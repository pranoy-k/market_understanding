{
  "id": "Hm7iTSgpu2of6gz4",
  "meta": {
    "instanceId": "bc8ca75c203589705ae2e446cad7181d6f2a7cc1766f958ef9f34810e53b8cb2",
    "templateCredsSetupCompleted": true
  },
  "name": "Google Maps Business Phone Number Scraper Using Bright Data API & Google Sheets Integration",
  "tags": [],
  "nodes": [
    {
      "id": "e5b879b7-5f3c-4679-95e4-6c32eae86080",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1340,
        20
      ],
      "parameters": {
        "width": 220,
        "height": 220,
        "content": "üìù Trigger - Start when form is submitted\n"
      },
      "typeVersion": 1
    },
    {
      "id": "703d65f1-bbc7-437a-8a82-a35b6ac04504",
      "name": "Form Trigger - Submit Location and Keywords",
      "type": "n8n-nodes-base.formTrigger",
      "position": [
        -1280,
        80
      ],
      "webhookId": "8b72dcdf-25a1-4b63-bb44-f918f7095d5d",
      "parameters": {
        "options": {},
        "formTitle": "GMB",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Location",
              "requiredField": true
            },
            {
              "fieldLabel": "keywords",
              "requiredField": true
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "1b5f22d3-c271-4d80-bc40-9b701a668c40",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1080,
        20
      ],
      "parameters": {
        "color": 3,
        "width": 220,
        "height": 220,
        "content": "Sends scraping request to Bright Data API"
      },
      "typeVersion": 1
    },
    {
      "id": "61dc6463-12db-453c-a732-dc0d924dc469",
      "name": "Bright Data API - Request Business Data",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1020,
        80
      ],
      "parameters": {
        "url": "https://api.brightdata.com/datasets/v3/trigger",
        "method": "POST",
        "options": {},
        "jsonBody": "={\n  \"input\": [\n    {\n      \"country\": \"{{ $json.Location }}\",\n      \"keyword\": \"{{ $json.keywords }}\",\n      \"lat\": \"\"\n    }\n  ],\n  \"custom_output_fields\": [\n   \n    \"url\",\n    \"country\",\n    \"name\",\n   \n    \"address\",\n    \"description\",\n    \n    \"open_hours\",\n    \"reviews_count\",\n    \"rating\",\n    \n    \"reviews\",\n    \"services_provided\",\n    \n    \"open_website\",\n    \"phone_number\",\n    \"permanently_closed\",\n    \"photos_and_videos\",\n    \"people_also_search\"\n   \n  ]\n} ",
        "sendBody": true,
        "sendQuery": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "queryParameters": {
          "parameters": [
            {
              "name": "dataset_id",
              "value": "gd_m8ebnr0q2qlklc02fz"
            },
            {
              "name": "include_errors",
              "value": "true"
            },
            {
              "name": "type",
              "value": "discover_new"
            },
            {
              "name": "discover_by",
              "value": "location"
            },
            {
              "name": "limit_per_input",
              "value": "2"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer BRIGHT_DATA_API_KEY"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "aae71edd-22bc-4bb9-a950-1c82aef6a30b",
      "name": "Check Scraping Status",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -780,
        80
      ],
      "parameters": {
        "url": "=https://api.brightdata.com/datasets/v3/progress/{{ $json.snapshot_id }}",
        "options": {},
        "sendQuery": true,
        "sendHeaders": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "format",
              "value": "json"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer BRIGHT_DATA_API_KEY"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "6370948d-f408-4cf8-8d3c-0c2db3665cae",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -840,
        0
      ],
      "parameters": {
        "color": 4,
        "width": 220,
        "height": 260,
        "content": "‚è≥ Check Status - Is data scraping completed?\n"
      },
      "typeVersion": 1
    },
    {
      "id": "1c016ecd-97db-4638-919f-2cc7136b2384",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -600,
        0
      ],
      "parameters": {
        "color": 5,
        "width": 200,
        "height": 260,
        "content": "‚úÖ Is Ready? - If ready, continue; if not, wait"
      },
      "typeVersion": 1
    },
    {
      "id": "67931cf3-a2c5-42e0-86b7-2b1611175037",
      "name": "Check If Status Ready",
      "type": "n8n-nodes-base.if",
      "position": [
        -560,
        80
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "or",
          "conditions": [
            {
              "id": "35ed620d-b5d5-4e97-bcc5-52b283d85616",
              "operator": {
                "name": "filter.operator.equals",
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.status }}",
              "rightValue": "ready"
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "9e089ddb-2cd2-4988-b070-a400d9a464e3",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -380,
        240
      ],
      "parameters": {
        "color": 7,
        "height": 240,
        "content": "‚è±Ô∏è Wait - Pause 1 min before checking again\n"
      },
      "typeVersion": 1
    },
    {
      "id": "594732d2-7a44-4b20-9cf6-81314933a857",
      "name": "Wait Before Retry",
      "type": "n8n-nodes-base.wait",
      "position": [
        -320,
        300
      ],
      "webhookId": "7047efad-de41-4608-b95c-d3e0203ef620",
      "parameters": {
        "unit": "minutes",
        "amount": 1
      },
      "typeVersion": 1.1
    },
    {
      "id": "34770c87-d63b-4bf8-a7e7-34fb579bd716",
      "name": "Check Records Exist",
      "type": "n8n-nodes-base.if",
      "position": [
        -280,
        60
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "f01bd215-c406-493c-a6e4-2b8ec5686b44",
              "operator": {
                "type": "number",
                "operation": "notEquals"
              },
              "leftValue": "={{ $json.records }}",
              "rightValue": "={{ 0 }}"
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "0119bde3-66e8-44f2-8991-dc4b9e02962e",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -360,
        -20
      ],
      "parameters": {
        "color": 4,
        "width": 260,
        "height": 240,
        "content": "üìä Has Data? - Proceed only if business records found\n"
      },
      "typeVersion": 1
    },
    {
      "id": "1cd6681e-47e5-4e82-8e12-408e299b9503",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -80,
        -40
      ],
      "parameters": {
        "color": 5,
        "width": 220,
        "height": 260,
        "content": "üì• Fetch Data - Get business info including phone numbers\n"
      },
      "typeVersion": 1
    },
    {
      "id": "135b9224-bcd2-4790-9066-278985874a3a",
      "name": "Fetch Business Data",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -20,
        40
      ],
      "parameters": {
        "url": "=https://api.brightdata.com/datasets/v3/snapshot/{{ $json.snapshot_id }}",
        "options": {},
        "sendQuery": true,
        "sendHeaders": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "format",
              "value": "json"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer BRIGHT_DATA_API_KEY"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "141e0fdc-56d7-42f4-92d4-93cda1ffe7e2",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        180,
        -40
      ],
      "parameters": {
        "color": 6,
        "width": 280,
        "height": 260,
        "content": "Saves business data to the GMB sheet in your Google SheetüìÑ Save to Sheet - Store business name, number, URL, etc.\n\n\t"
      },
      "typeVersion": 1
    },
    {
      "id": "3a0e1f5b-d923-47a0-b036-c18ac260980a",
      "name": "Save to Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        260,
        40
      ],
      "parameters": {
        "columns": {
          "value": {
            "URL": "={{ $json.url }}",
            "Name": "={{ $json.name }}",
            "Rating": "={{ $json.rating }}",
            "Address": "={{ $json.address }}",
            "Phone Number": "={{ $json.phone_number }}"
          },
          "schema": [
            {
              "id": "Name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "URL",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "URL",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Rating",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Rating",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone Number",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Phone Number",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Address",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Address",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "append",
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": 619305781,
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID/edit#gid=619305781",
          "cachedResultName": "GMB"
        },
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "YOUR_GOOGLE_SHEET_ID",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID/edit?usp=drivesdk",
          "cachedResultName": "Business Data Sheet"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_GOOGLE_SHEETS_CREDENTIAL_ID",
          "name": "Google Sheets OAuth2"
        }
      },
      "typeVersion": 4.6
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "0bed9bf1-00a3-4eb6-bf7c-cf07bee006a2",
  "connections": {
    "Wait Before Retry": {
      "main": [
        [
          {
            "node": "Check Scraping Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Records Exist": {
      "main": [
        [
          {
            "node": "Fetch Business Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Business Data": {
      "main": [
        [
          {
            "node": "Save to Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check If Status Ready": {
      "main": [
        [
          {
            "node": "Check Records Exist",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait Before Retry",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Scraping Status": {
      "main": [
        [
          {
            "node": "Check If Status Ready",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bright Data API - Request Business Data": {
      "main": [
        [
          {
            "node": "Check Scraping Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Form Trigger - Submit Location and Keywords": {
      "main": [
        [
          {
            "node": "Bright Data API - Request Business Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}